!function(e,t,n,a){var l="table2excel",i={exclude:".noExl",name:"Table2Excel",filename:"table2excel",fileext:".xls",exclude_img:!0,exclude_links:!0,exclude_inputs:!0};function s(t,n){this.element=t,this.settings=e.extend({},i,n),this._defaults=i,this._name=l,this.init()}function o(e){return e.filename?e.filename:"table2excel"}s.prototype={init:function(){var t=this;t.template={head:'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets>',sheet:{head:"<x:ExcelWorksheet><x:Name>",tail:"</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet>"},mid:"</x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body>",table:{head:"<table>",tail:"</table>"},foot:"</body></html>"},t.tableRows=[],e(t.element).each(function(n,a){var l,i="";e(a).find("tr").not(t.settings.exclude).each(function(n,a){i+="<tr>",e(a).find("td,th").not(t.settings.exclude).each(function(n,a){var l=e(this).attr("rowspan"),s=e(this).attr("colspan");e(a).find(t.settings.exclude).length>0?i+="<td> </td>":l&s?i+="<td>"+e(a).html()+"</td>":(i+="<td",l>0&&(i+=" rowspan='"+l+"' "),s>0&&(i+=" colspan='"+s+"' "),i+="/>"+e(a).html()+"</td>")}),i+="</tr>"}),t.settings.exclude_img&&(l=/(\s+alt\s*=\s*"([^"]*)"|\s+alt\s*=\s*'([^']*)')/i,i=i.replace(/<img[^>]*>/gi,function(e){var t=l.exec(e);return null!==t&&t.length>=2?t[2]:""})),t.settings.exclude_links&&(i=function(e){return e.replace(/<a[^>]*>|<\/a>/gi,"")}(i)),t.settings.exclude_inputs&&(i=function(e){var t=/(\s+value\s*=\s*"([^"]*)"|\s+value\s*=\s*'([^']*)')/i;return e.replace(/<input[^>]*>|<\/input>/gi,function(e){var n=t.exec(e);return null!==n&&n.length>=2?n[2]:""})}(i)),t.tableRows.push(i)}),t.tableToExcel(t.tableRows,t.settings.name,t.settings.sheetName)},tableToExcel:function(a,l,i){var s,c,r,x=this,m="";if(x.format=function(e,t){return e.replace(/{(\w+)}/g,function(e,n){return t[n]})},i=void 0===i?"Sheet":i,x.ctx={worksheet:l||"Worksheet",table:a,sheetName:i},m=x.template.head,e.isArray(a))for(s in a)m+=x.template.sheet.head+i+s+x.template.sheet.tail;if(m+=x.template.mid,e.isArray(a))for(s in a)m+=x.template.table.head+"{table"+s+"}"+x.template.table.tail;for(s in m+=x.template.foot,a)x.ctx["table"+s]=a[s];if(delete x.ctx.table,!!n.documentMode)if("undefined"!=typeof Blob){m=[m=x.format(m,x.ctx)];var d=new Blob(m,{type:"text/html"});t.navigator.msSaveBlob(d,o(x.settings))}else txtArea1.document.open("text/html","replace"),txtArea1.document.write(x.format(m,x.ctx)),txtArea1.document.close(),txtArea1.focus(),sa=txtArea1.document.execCommand("SaveAs",!0,o(x.settings));else{var u=new Blob([x.format(m,x.ctx)],{type:"application/vnd.ms-excel"});t.URL=t.URL||t.webkitURL,c=t.URL.createObjectURL(u),(r=n.createElement("a")).download=o(x.settings),r.href=c,n.body.appendChild(r),r.click(),n.body.removeChild(r)}return!0}},e.fn[l]=function(t){var n=this;return n.each(function(){e.data(n,"plugin_"+l)||e.data(n,"plugin_"+l,new s(this,t))}),n}}(jQuery,window,document);
